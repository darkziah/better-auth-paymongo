{
  "version": 3,
  "sources": ["../src/react.ts"],
  "sourcesContent": [
    "/**\n * React utilities for better-auth-paymongo\n * \n * When using better-auth's React client (createAuthClient from \"better-auth/react\"),\n * hooks are automatically generated from the plugin's getAtoms():\n * \n * - client.useConfig() - Returns the config (plans and addons)\n * - client.useSubscription() - Returns the current subscription\n * \n * This module exports helper functions to compute limits and extract\n * useful data from the hook results.\n */\n\nimport type { SubscriptionData, BasePlanConfig, BaseAddonConfig } from \"./types\";\nimport type { PaymongoConfig } from \"./client\";\n\n// Re-export types for convenience\nexport type { PaymongoConfig } from \"./client\";\nexport type { SubscriptionData, BasePlanConfig, BaseAddonConfig } from \"./types\";\n\n// =============================================================================\n// Type for useConfig/useSubscription hook results (from better-auth)\n// =============================================================================\n\nexport interface AuthQueryResult<T> {\n  data: T | null;\n  error: { message: string } | null;\n  isPending: boolean;\n  isRefetching: boolean;\n  refetch: (queryParams?: { query?: Record<string, string> }) => Promise<void>;\n}\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/**\n * Compute limits by merging base plan limits with add-on bonuses\n */\nexport function computeLimits(\n  subscription: SubscriptionData | null,\n  plans: Record<string, BasePlanConfig>,\n  addons?: Record<string, BaseAddonConfig>\n): Record<string, number> {\n  if (!subscription) return {};\n\n  const plan = plans[subscription.planId];\n  if (!plan) return {};\n\n  const limits = { ...plan.limits };\n\n  if (addons && subscription.addons) {\n    for (const [addonId, qty] of Object.entries(subscription.addons)) {\n      const addon = addons[addonId];\n      if (addon?.limitBonuses) {\n        for (const [key, bonus] of Object.entries(addon.limitBonuses)) {\n          limits[key] = (limits[key] || 0) + bonus * qty;\n        }\n      }\n    }\n  }\n\n  return limits;\n}\n\n/**\n * Extract the current plan from config and subscription data\n */\nexport function getCurrentPlan(\n  config: PaymongoConfig | null,\n  subscription: SubscriptionData | null\n): BasePlanConfig | null {\n  if (!config || !subscription) return null;\n  return config.plans[subscription.planId] ?? null;\n}\n\n/**\n * Check if a subscription is active (active or trialing)\n */\nexport function isSubscriptionActive(subscription: SubscriptionData | null): boolean {\n  return subscription?.status === \"active\" || subscription?.status === \"trialing\";\n}\n\n/**\n * Get trial status information\n */\nexport function getTrialStatus(subscription: SubscriptionData | null): {\n  isTrialing: boolean;\n  trialEndsAt: Date | null;\n  daysRemaining: number;\n  hasUsedTrial: boolean;\n} {\n  const isTrialing = subscription?.status === \"trialing\";\n  let trialEndsAt: Date | null = null;\n  let daysRemaining = 0;\n\n  if (subscription?.trialEndsAt) {\n    trialEndsAt = new Date(subscription.trialEndsAt);\n    const now = new Date();\n    const msRemaining = trialEndsAt.getTime() - now.getTime();\n    daysRemaining = Math.max(0, Math.ceil(msRemaining / (1000 * 60 * 60 * 24)));\n  }\n\n  return {\n    isTrialing,\n    trialEndsAt,\n    daysRemaining,\n    hasUsedTrial: !!subscription?.trialUsedAt\n  };\n}\n\n/**\n * Get usage information for a specific limit\n */\nexport function getUsageInfo(\n  limitKey: string,\n  subscription: SubscriptionData | null,\n  config: PaymongoConfig | null,\n  includeAddons: boolean = true\n): {\n  usage: number;\n  limit: number;\n  remaining: number;\n  isOverLimit: boolean;\n} {\n  const usage = subscription?.usage?.[limitKey] ?? 0;\n  let limit = 0;\n\n  if (subscription?.planId && config?.plans[subscription.planId]) {\n    const computedLimits = includeAddons\n      ? computeLimits(subscription, config.plans, config.addons)\n      : (config.plans[subscription.planId]?.limits ?? {});\n    limit = computedLimits[limitKey] ?? 0;\n  }\n\n  const remaining = Math.max(0, limit - usage);\n  const isOverLimit = usage >= limit && limit > 0;\n\n  return { usage, limit, remaining, isOverLimit };\n}\n\n/**\n * Format price amount for display\n * @param amount Amount in smallest currency unit (e.g., centavos)\n * @param currency Currency code (e.g., \"PHP\")\n */\nexport function formatPrice(amount: number, currency: string): string {\n  const majorUnits = amount / 100;\n  return new Intl.NumberFormat(undefined, {\n    style: \"currency\",\n    currency: currency\n  }).format(majorUnits);\n}\n"
  ],
  "mappings": ";AAuCO,SAAS,aAAa,CAC3B,cACA,OACA,QACwB;AAAA,EACxB,IAAI,CAAC;AAAA,IAAc,OAAO,CAAC;AAAA,EAE3B,MAAM,OAAO,MAAM,aAAa;AAAA,EAChC,IAAI,CAAC;AAAA,IAAM,OAAO,CAAC;AAAA,EAEnB,MAAM,SAAS,KAAK,KAAK,OAAO;AAAA,EAEhC,IAAI,UAAU,aAAa,QAAQ;AAAA,IACjC,YAAY,SAAS,QAAQ,OAAO,QAAQ,aAAa,MAAM,GAAG;AAAA,MAChE,MAAM,QAAQ,OAAO;AAAA,MACrB,IAAI,OAAO,cAAc;AAAA,QACvB,YAAY,KAAK,UAAU,OAAO,QAAQ,MAAM,YAAY,GAAG;AAAA,UAC7D,OAAO,QAAQ,OAAO,QAAQ,KAAK,QAAQ;AAAA,QAC7C;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EAEA,OAAO;AAAA;AAMF,SAAS,cAAc,CAC5B,QACA,cACuB;AAAA,EACvB,IAAI,CAAC,UAAU,CAAC;AAAA,IAAc,OAAO;AAAA,EACrC,OAAO,OAAO,MAAM,aAAa,WAAW;AAAA;AAMvC,SAAS,oBAAoB,CAAC,cAAgD;AAAA,EACnF,OAAO,cAAc,WAAW,YAAY,cAAc,WAAW;AAAA;AAMhE,SAAS,cAAc,CAAC,cAK7B;AAAA,EACA,MAAM,aAAa,cAAc,WAAW;AAAA,EAC5C,IAAI,cAA2B;AAAA,EAC/B,IAAI,gBAAgB;AAAA,EAEpB,IAAI,cAAc,aAAa;AAAA,IAC7B,cAAc,IAAI,KAAK,aAAa,WAAW;AAAA,IAC/C,MAAM,MAAM,IAAI;AAAA,IAChB,MAAM,cAAc,YAAY,QAAQ,IAAI,IAAI,QAAQ;AAAA,IACxD,gBAAgB,KAAK,IAAI,GAAG,KAAK,KAAK,eAAe,OAAO,KAAK,KAAK,GAAG,CAAC;AAAA,EAC5E;AAAA,EAEA,OAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,cAAc,CAAC,CAAC,cAAc;AAAA,EAChC;AAAA;AAMK,SAAS,YAAY,CAC1B,UACA,cACA,QACA,gBAAyB,MAMzB;AAAA,EACA,MAAM,QAAQ,cAAc,QAAQ,aAAa;AAAA,EACjD,IAAI,QAAQ;AAAA,EAEZ,IAAI,cAAc,UAAU,QAAQ,MAAM,aAAa,SAAS;AAAA,IAC9D,MAAM,iBAAiB,gBACnB,cAAc,cAAc,OAAO,OAAO,OAAO,MAAM,IACtD,OAAO,MAAM,aAAa,SAAS,UAAU,CAAC;AAAA,IACnD,QAAQ,eAAe,aAAa;AAAA,EACtC;AAAA,EAEA,MAAM,YAAY,KAAK,IAAI,GAAG,QAAQ,KAAK;AAAA,EAC3C,MAAM,cAAc,SAAS,SAAS,QAAQ;AAAA,EAE9C,OAAO,EAAE,OAAO,OAAO,WAAW,YAAY;AAAA;AAQzC,SAAS,WAAW,CAAC,QAAgB,UAA0B;AAAA,EACpE,MAAM,aAAa,SAAS;AAAA,EAC5B,OAAO,IAAI,KAAK,aAAa,WAAW;AAAA,IACtC,OAAO;AAAA,IACP;AAAA,EACF,CAAC,EAAE,OAAO,UAAU;AAAA;",
  "debugId": "3B24400A1869146664756E2164756E21",
  "names": []
}